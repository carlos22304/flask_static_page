<!-- templates/chat.html -->
{% extends "base.html" %}

{% block title %}Chat{% endblock %}

{% block content %}
<h1 class="text-center">Talk to the Chattanooga Bot</h1>
<div id="chat-box" style="height: 300px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px;"></div>
<form id="chat-form" class="mt-3">
    <input type="text" id="user-input" class="form-control" placeholder="Ask me something..." autocomplete="off" required>
    <button type="submit" class="btn btn-primary mt-2">Send</button>
</form>

<script>
    const form = document.getElementById("chat-form");
    const chatBox = document.getElementById("chat-box");

    form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const input = document.getElementById("user-input").value;
        chatBox.innerHTML += `<p><strong>You:</strong> ${input}</p>`;

        const res = await fetch("/chat", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message: input })
        });

        const data = await res.json();
        chatBox.innerHTML += `<p><strong>Bot:</strong> ${data.response}</p>`;

        // Use speech synthesis
        const utter = new SpeechSynthesisUtterance(data.response);
        speechSynthesis.speak(utter);

        form.reset();
    });
</script>
{% endblock %}
